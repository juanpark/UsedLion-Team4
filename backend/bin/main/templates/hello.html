<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hello Page</title>
  </head>
  <style>
    /* 테이블을 포함할 컨테이너 스타일 */
    .table-container {
      height: 1000px; /* 원하는 높이로 설정 */
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px;
    }

    /* 테이블 스타일 */
    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 8px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    /* 테이블 폰트 스타일 */
    body {
      font-family: Arial, sans-serif;
    }

    /* 검색창 컨테이너 스타일 */
    .search-container {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .search-container input[type="text"] {
      padding: 8px;
      margin-right: 10px;
      width: 300px;
    }

    .search-container button {
      padding: 8px 16px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    /* 조건 버튼 스타일 */
    #filterToggle {
      background-color: #007bff;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-bottom: 20px;
    }

    /* 필터 메뉴 스타일 */
    #filterMenu {
      display: none;
      background-color: #f4f4f4;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      padding: 10px;
      margin-top: 10px;
      width: 200px;
      position: absolute;
    }

    #filterMenu label {
      display: block;
      padding: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    #filterMenu label:hover {
      background-color: #007bff;
      color: white;
    }

    /* 검색창 스타일 */
    #searchInput {
      width: 300px;
      padding: 8px;
    }
  </style>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      document
        .getElementById("filterToggle")
        .addEventListener("click", function () {
          const filterMenu = document.getElementById("filterMenu");
          filterMenu.style.display =
            filterMenu.style.display === "none" ? "block" : "none";
        });

      const filterInputs = document.querySelectorAll('input[name="filter"]');
      filterInputs.forEach((input) => {
        input.addEventListener("change", function () {
          const filterMenu = document.getElementById("filterMenu");
          filterMenu.style.display = "none";
        });
      });
    });
    function search() {
      const searchInput = document.getElementById("searchInput").value;
      const selectedFilter = document.querySelector(
        'input[name="filter"]:checked'
      );

      if (selectedFilter && searchInput.trim() !== "") {
        const filterValue = selectedFilter.value;
        window.location.href = `/post/search/detail?${filterValue}=${searchInput}`;
      } else {
        alert("검색어와 조건을 선택해주세요.");
      }
    }
    function clearPage() {
      document.getElementById("searchInput").value = "";
      const filterInputs = document.querySelectorAll('input[name="filter"]');
      filterInputs.forEach((input) => {
        input.checked = false;
      });
      window.location.href = "/hello";
    }
  </script>
  <body>
    <h1>안녕하세요, <span th:text="${username}">이름</span> 님!</h1>

    <a th:href="@{/post/create}">
      <button
        style="
          padding: 8px 16px;
          background-color: #007bff;
          color: white;
          border: none;
          border-radius: 4px;
          cursor: pointer;
        "
      >
        게시글 작성
      </button>
    </a>
    <h2>게시판 글 목록</h2>
    <div class="search-container">
      <button id="filterToggle">조건</button>
      <input type="text" id="searchInput" placeholder="검색어 입력" />
      <button onclick="search()">검색</button>
      <button onclick="clearPage()">초기화</button>
    </div>
    <div th:if="${filter}">
      <p>
        검색 조건:
        <span th:text="|${filter} 이 ${condition}을 포함하는 결과|"></span>
      </p>
    </div>

    <div id="filterMenu">
      <label>
        <input type="radio" name="filter" value="title" checked /> 제목
      </label>
      <label>
        <input type="radio" name="filter" value="username" /> 닉네임
      </label>
      <label> <input type="radio" name="filter" value="content" /> 내용 </label>
    </div>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>제목</th>
            <th>작성자</th>
            <th>조회수</th>
            <th>작성일</th>
          </tr>
        </thead>
        <tbody>
          <!-- 게시글 목록을 출력 -->
          <th:block th:each="post : ${posts}">
            <tr>
              <td>
                <a
                  th:href="@{/post/{postId}(postId=${post.post.postId})}"
                  th:text="${post.post.title}"
                  style="color: #007bff; text-decoration: none"
                  >게시글 제목</a
                >
              </td>
              <td>
                <a
                  th:href="@{/user/{profileId}(profileId=${post.post.profileId})}"
                  th:text="${post.post.username}"
                  style="color: #007bff; text-decoration: none"
                  >작성자</a
                >
              </td>

              <td th:text="${post.post.view}">조회수</td>
              <td
                th:text="${#temporals.format(post.post.date, 'yyyy-MM-dd HH:mm')}"
              >
                작성일
              </td>
              <td>
                <img
                  th:if="${post.img != null}"
                  th:src="'data:image/jpeg;base64,' + ${post.img}"
                  alt="게시글 이미지"
                />
              </td>
            </tr>
          </th:block>
        </tbody>
      </table>
    </div>
  </body>
</html>
