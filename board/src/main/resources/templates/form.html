<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>글쓰기</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { background-color: #ffffff; font-family: 'Noto Sans KR', sans-serif; }
    .header { background: linear-gradient(to right, #4f46e5, #3b82f6); color: white; padding: 1rem 2rem; }
  </style>
</head>
<body>
<div class="header d-flex justify-content-between align-items-center">
  <h4 class="m-0" th:text="${post.id} != null ? '✏️ 글 수정' : '✏️ 글쓰기'">✏️ 글쓰기</h4>
  <a href="/" class="btn btn-light">목록</a>
</div>

<div class="container mt-4">
  <form th:action="${post.id} != null ? @{'/posts/update/' + ${post.id}} : @{/posts}" method="post" enctype="multipart/form-data">

    <!-- ✅ 무조건 렌더링되는 고정 숨겨진 필드 -->
    <input type="hidden" name="userId" value="1" />
    <input type="hidden" name="profileId" value="1" />
    <input type="hidden" name="likes" th:value="${post.likes != null ? post.likes : 0}" />
    <input type="hidden" name="view" th:value="${post.view != null ? post.view : 0}" />
    <input type="hidden" name="complete" th:value="${post.complete != null ? post.complete : false}" />

    <div class="mb-3">
      <label class="form-label">제목</label>
      <input type="text" class="form-control" name="title" th:value="${post.title}" required />
    </div>

    <div class="mb-3">
      <label class="form-label">내용</label>
      <textarea class="form-control" name="content" rows="4" required th:text="${post.content}"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">가격</label>
      <input type="number" class="form-control" name="price" th:value="${post.price}" required />
    </div>

    <div class="mb-3">
      <label class="form-label">이미지 파일 (선택)</label>
      <input type="file" class="form-control" name="fileUpload" />
    </div>

    <div class="mb-3">
      <label class="form-label">상태</label>
      <select class="form-control" name="status" required>
        <option th:each="s : ${statuses}" th:value="${s}" th:text="${s}" th:selected="${s} == ${post.status}">ONSALE</option>
      </select>
    </div>

    <button type="submit" class="btn btn-primary">💾 저장</button>
  </form>
</div>
</body>
</html>

